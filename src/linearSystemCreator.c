// Implementado por Eduardo Machado e Bruna Maciel
// 2016

#include "linearSystemCreator.h"

/***********************
 * N: tamanho do sistema linear
 * k: numero da diagonal, 0 = diagonal principal, 1 = acima/abaixo da diagonal, 2 = ...
 * nBandas: numero de bandas do sistema linear
 * diag: vetor para armazenar os valores da diagonal. Deve ser alocado por quem chama a função.
 ***********************/
int generateRandomDiagonal(unsigned int N, unsigned int k, unsigned int nBandas, double *diag)
{
  if ( !diag || N < 3 || nBandas > N/2 || k < 0 || k > nBandas )
    return (-1);

  /* garante valor dominante para diagonal principal */
  double fator = (k == 0) ? ((double)(nBandas-1)) : (0.0);

  double invRandMax = 1.0 / (double)RAND_MAX;

  for (int i=0; i < N-k; ++i)
  {
    diag[i] = fator + (double)rand() * invRandMax;
  }

  return (0);
}

double independentTermGenerator(double x)
{
  return(4*M_PI*M_PI*(sin(2*M_PI*x)+sin(2*M_PI*(M_PI-x))));
}
